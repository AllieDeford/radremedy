{% extends 'base.html' %}

{% block title %}Rad Remedy - {{ provider.name }}{% endblock %}
{% block head_text %}Provider{% endblock %}
{% block head_blurb %}This is where we would a nice blurb about what RAD is, who 
            should use it, and what they might use it for. Also, this is a good 
            spot for a short version of our mission statement!{% endblock %}

{% block content %}
<div class="content-temp">

<h3>{{ provider.name }}</h3>

{% if provider.organization %}
<h2>
	{{ provider.organization }}
</h2>
{% endif %}

{% if provider.categories %}
<h4>
	{{ provider.categories|join(', ', attribute='name') }}
</h4>
{% endif %}

{% if provider.description %}
<blockquote>
	{{ provider.description }}
</blockquote>
{% endif %}

{% if provider.address %}
<h2>Location</h2>
<p>{{ provider.address }}</p>
{% endif %}

<h2>Contact</h2>

{% if provider.email %}
<p>Email: <a href="mailto:{{ provider.email }}">{{ provider.email }}</a></p>
{% endif %}

{% if provider.phone %}
<p>Phone: {{ provider.phone }}</p>
{% endif %}

{% if provider.fax %}
<p>Fax: {{ provider.fax }}</p>
{% endif %}

{% if provider.url %}
<p><a href="{% if not provider.url.startswith(('http://', 'https://')) %}http://{% endif %}{{ provider.url }}" target="_blank">Find out More</a></p>
{% endif %}

<hr>

<p>
	Notice something wrong with this reference? 
	<a href="{{ url_for('remedy.submit_error', resource_id=provider.id) }}">Let us know.</a>
</p>

<h2>Reviews</h2>

{% if reviews|count > 0 %}
  {% for review in reviews %}
    <div>
      <p>
        {{ review.user.username }} -
        <strong>{{ macros.rating_text(review.rating) }}</strong>
      </p>
      <blockquote>
        {{ review.text }}
      </blockquote>
      {% if review.old_reviews.all()|count > 0 %}
        <p>
          Previous Reviews
        </p>
        {% for old_review in review.old_reviews %}
          <div>
            <p>
              {{ macros.rating_text(review.rating) }}
            </p>
            <p>
              {{ old_review.text }}
            </p>
          </div>
        {% endfor %}
      {% endif %}
    </div>
  {% endfor %}
{% else %}
<p>
  Nobody has reviewed this provider yet. Be the first!
</p>
{% endif %}

{% include 'experiences.html' %}

</div>


{% endblock %}
